(function(g,h,e){var c=h.module("ngDialog",[]);var j=h.element;var b=h.isDefined;var a=(document.body||document.documentElement).style;var i=b(a.animation)||b(a.WebkitAnimation)||b(a.MozAnimation)||b(a.MsAnimation)||b(a.OAnimation);var f="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend";var d=false;c.provider("ngDialog",function(){var n=this.defaults={className:"ngdialog-theme-default",plain:false,showClose:true,closeByDocument:true,closeByEscape:true,closeByNavigation:false,appendTo:false,preCloseCallback:false,overlay:true,cache:true};this.setForceBodyReload=function(q){d=q||false};this.setDefaults=function(q){h.extend(n,q)};var l=0,m=0,k,p,o={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller",function(v,u,x,z,A,B,t,s,q){var w=v.find("body");if(d){B.$on("$locationChangeSuccess",function(){w=v.find("body")})}var r={onDocumentKeydown:function(C){if(C.keyCode===27){y.close("$escape")}},setBodyPadding:function(D){var C=parseInt((w.css("padding-right")||0),10);w.css("padding-right",(C+D)+"px");w.data("ng-dialog-original-padding",C)},resetBodyPadding:function(){var C=w.data("ng-dialog-original-padding");if(C){w.css("padding-right",C+"px")}else{w.css("padding-right","")}},performCloseDialog:function(D,C){var G=D.attr("id");var E=j(D[0].getElementsByClassName("ngdialog-overlay"));var F=j(D[0].getElementsByClassName("ngdialog-close"));E.unbind("click touchstart");F.unbind("click touchstart");if(m===1){w.unbind("keydown")}if(!D.hasClass("ngdialog-closing")){m-=1}B.$broadcast("ngDialog.closing",D);if(i){D.unbind(f).bind(f,function(){D.scope().$destroy();D.remove();if(m===0){w.removeClass("ngdialog-open");r.resetBodyPadding()}B.$broadcast("ngDialog.closed",D)}).addClass("ngdialog-closing")}else{D.scope().$destroy();D.remove();if(m===0){w.removeClass("ngdialog-open");r.resetBodyPadding()}B.$broadcast("ngDialog.closed",D)}if(o[G]){o[G].resolve({id:G,value:C,$dialog:D,remainingDialogs:m});delete o[G]}},closeDialog:function(E,D){var F=E.data("$ngDialogPreCloseCallback");if(F&&h.isFunction(F)){var C=F.call(E,D);if(h.isObject(C)){if(C.closePromise){C.closePromise.then(function(){r.performCloseDialog(E,D)})}else{C.then(function(){r.performCloseDialog(E,D)},function(){return})}}else{if(C!==false){r.performCloseDialog(E,D)}}}else{r.performCloseDialog(E,D)}}};var y={open:function(D){var J=this;var K=h.copy(n);D=D||{};h.extend(K,D);l+=1;J.latestID="ngdialog"+l;var C;o[J.latestID]=C=z.defer();var I=h.isObject(K.scope)?K.scope.$new():B.$new();var F,G;z.when(E(K.template||K.templateUrl)).then(function(M){u.put(K.template||K.templateUrl,M);if(K.showClose){M+='<div class="ngdialog-close"></div>'}J.$result=F=j('<div id="ngdialog'+l+'" class="ngdialog"></div>');F.html((K.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content">'+M+"</div>":'<div class="ngdialog-content">'+M+"</div>"));if(K.data&&h.isString(K.data)){var Q=K.data.replace(/^\s*/,"")[0];I.ngDialogData=(Q==="{"||Q==="[")?h.fromJson(K.data):K.data}else{if(K.data&&h.isObject(K.data)){I.ngDialogData=h.fromJson(h.toJson(K.data))}}if(K.controller&&(h.isString(K.controller)||h.isArray(K.controller)||h.isFunction(K.controller))){var L=q(K.controller,{$scope:I,$element:F});F.data("$ngDialogControllerController",L)}if(K.className){F.addClass(K.className)}if(K.appendTo&&h.isString(K.appendTo)){G=h.element(document.querySelector(K.appendTo))}else{G=w}if(K.preCloseCallback){var O;if(h.isFunction(K.preCloseCallback)){O=K.preCloseCallback}else{if(h.isString(K.preCloseCallback)){if(I){if(h.isFunction(I[K.preCloseCallback])){O=I[K.preCloseCallback]}else{if(I.$parent&&h.isFunction(I.$parent[K.preCloseCallback])){O=I.$parent[K.preCloseCallback]}else{if(B&&h.isFunction(B[K.preCloseCallback])){O=B[K.preCloseCallback]}}}}}}if(O){F.data("$ngDialogPreCloseCallback",O)}}I.closeThisDialog=function(R){r.closeDialog(F,R)};t(function(){x(F)(I);var S=s.innerWidth-w.prop("clientWidth");w.addClass("ngdialog-open");var R=S-(s.innerWidth-w.prop("clientWidth"));if(R>0){r.setBodyPadding(R)}G.append(F);if(K.name){B.$broadcast("ngDialog.opened",{dialog:F,name:K.name})}else{B.$broadcast("ngDialog.opened",F)}});if(K.closeByEscape){w.bind("keydown",r.onDocumentKeydown)}if(K.closeByNavigation){B.$on("$locationChangeSuccess",function(){r.closeDialog(F)})}k=function(R){y.close(F.attr("id"),"$document")};p=function(R){y.close(F.attr("id"),"$closeButton")};var N=j(F[0].getElementsByClassName("ngdialog-overlay"));var P=j(F[0].getElementsByClassName("ngdialog-close"));N.bind("click touchstart",k);P.bind("click touchstart",p);m+=1;return y});return{id:"ngdialog"+l,closePromise:C.promise,close:function(L){r.closeDialog(F,L)}};function H(L,M){return A.get(L,(M||{})).then(function(N){return N.data||""})}function E(L){if(!L){return"Empty template"}if(h.isString(L)&&K.plain){return L}if(typeof K.cache==="boolean"&&!K.cache){return H(L,{cache:false})}return u.get(L)||H(L,{cache:true})}},openConfirm:function(E){var F=z.defer();var D={closeByEscape:false,closeByDocument:false};h.extend(D,E);D.scope=h.isObject(D.scope)?D.scope.$new():B.$new();D.scope.confirm=function(H){F.resolve(H);var G=j(document.getElementById(C.id));r.performCloseDialog(G,H)};var C=y.open(D);C.closePromise.then(function(G){if(G){return F.reject(G.value)}return F.reject()});return F.promise},close:function(E,D){var C=j(document.getElementById(E));if(C.length){r.closeDialog(C,D)}else{y.closeAll(D)}return y},closeAll:function(D){var C=document.querySelectorAll(".ngdialog");h.forEach(C,function(E){r.closeDialog(j(E),D)})},getDefaults:function(){return n}};return y}]});c.directive("ngDialog",["ngDialog",function(k){return{restrict:"A",scope:{ngDialogScope:"="},link:function(m,n,l){n.on("click",function(q){q.preventDefault();var p=h.isDefined(m.ngDialogScope)?m.ngDialogScope:"noScope";h.isDefined(l.ngDialogClosePrevious)&&k.close(l.ngDialogClosePrevious);var o=k.getDefaults();k.open({template:l.ngDialog,className:l.ngDialogClass||o.className,controller:l.ngDialogController,scope:p,data:l.ngDialogData,showClose:l.ngDialogShowClose==="false"?false:(l.ngDialogShowClose==="true"?true:o.showClose),closeByDocument:l.ngDialogCloseByDocument==="false"?false:(l.ngDialogCloseByDocument==="true"?true:o.closeByDocument),closeByEscape:l.ngDialogCloseByEscape==="false"?false:(l.ngDialogCloseByEscape==="true"?true:o.closeByEscape),preCloseCallback:l.ngDialogPreCloseCallback||o.preCloseCallback})})}}}])})(window,window.angular);