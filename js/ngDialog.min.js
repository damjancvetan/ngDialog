(function(g,h,e){var c=h.module("ngDialog",[]);var j=h.element;var b=h.isDefined;var a=(document.body||document.documentElement).style;var i=b(a.animation)||b(a.WebkitAnimation)||b(a.MozAnimation)||b(a.MsAnimation)||b(a.OAnimation);var f="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend";var d=false;c.provider("ngDialog",function(){var n=this.defaults={className:"ngdialog-theme-default",plain:false,showClose:true,closeByDocument:true,closeByEscape:true,closeByNavigation:false,appendTo:false,preCloseCallback:false,overlay:true,cache:true};this.setForceBodyReload=function(p){d=p||false};this.setDefaults=function(p){h.extend(n,p)};var l=0,m=0,k,o={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller",function(u,t,w,y,z,A,s,r,p){var v=u.find("body");if(d){A.$on("$locationChangeSuccess",function(){v=u.find("body")})}var q={onDocumentKeydown:function(B){if(B.keyCode===27){x.close("$escape")}},setBodyPadding:function(C){var B=parseInt((v.css("padding-right")||0),10);v.css("padding-right",(B+C)+"px");v.data("ng-dialog-original-padding",B)},resetBodyPadding:function(){var B=v.data("ng-dialog-original-padding");if(B){v.css("padding-right",B+"px")}else{v.css("padding-right","")}},performCloseDialog:function(E,D){var F=E.attr("id");if(typeof g.Hammer!=="undefined"){var C=h.element(E).scope().hammerTime;C.off("tap",k);try{C.destroy()}catch(B){}delete E.scope().hammerTime}else{E.unbind("click")}if(m===1){v.unbind("keydown")}if(!E.hasClass("ngdialog-closing")){m-=1}A.$broadcast("ngDialog.closing",E);if(i){E.unbind(f).bind(f,function(){E.scope().$destroy();E.remove();if(m===0){v.removeClass("ngdialog-open");q.resetBodyPadding()}A.$broadcast("ngDialog.closed",E)}).addClass("ngdialog-closing")}else{E.scope().$destroy();E.remove();if(m===0){v.removeClass("ngdialog-open");q.resetBodyPadding()}A.$broadcast("ngDialog.closed",E)}if(o[F]){o[F].resolve({id:F,value:D,$dialog:E,remainingDialogs:m});delete o[F]}},closeDialog:function(D,C){var E=D.data("$ngDialogPreCloseCallback");if(E&&h.isFunction(E)){var B=E.call(D,C);if(h.isObject(B)){if(B.closePromise){B.closePromise.then(function(){q.performCloseDialog(D,C)})}else{B.then(function(){q.performCloseDialog(D,C)},function(){return})}}else{if(B!==false){q.performCloseDialog(D,C)}}}else{q.performCloseDialog(D,C)}}};var x={open:function(C){var I=this;var J=h.copy(n);C=C||{};h.extend(J,C);l+=1;I.latestID="ngdialog"+l;var B;o[I.latestID]=B=y.defer();var H=h.isObject(J.scope)?J.scope.$new():A.$new();var E,F;y.when(D(J.template||J.templateUrl)).then(function(L){t.put(J.template||J.templateUrl,L);if(J.showClose){L+='<div class="ngdialog-close"></div>'}I.$result=E=j('<div id="ngdialog'+l+'" class="ngdialog"></div>');E.html((J.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content">'+L+"</div>":'<div class="ngdialog-content">'+L+"</div>"));if(J.data&&h.isString(J.data)){var O=J.data.replace(/^\s*/,"")[0];H.ngDialogData=(O==="{"||O==="[")?h.fromJson(J.data):J.data}else{if(J.data&&h.isObject(J.data)){H.ngDialogData=h.fromJson(h.toJson(J.data))}}if(J.controller&&(h.isString(J.controller)||h.isArray(J.controller)||h.isFunction(J.controller))){var K=p(J.controller,{$scope:H,$element:E});E.data("$ngDialogControllerController",K)}if(J.className){E.addClass(J.className)}if(J.appendTo&&h.isString(J.appendTo)){F=h.element(document.querySelector(J.appendTo))}else{F=v}if(J.preCloseCallback){var N;if(h.isFunction(J.preCloseCallback)){N=J.preCloseCallback}else{if(h.isString(J.preCloseCallback)){if(H){if(h.isFunction(H[J.preCloseCallback])){N=H[J.preCloseCallback]}else{if(H.$parent&&h.isFunction(H.$parent[J.preCloseCallback])){N=H.$parent[J.preCloseCallback]}else{if(A&&h.isFunction(A[J.preCloseCallback])){N=A[J.preCloseCallback]}}}}}}if(N){E.data("$ngDialogPreCloseCallback",N)}}H.closeThisDialog=function(P){q.closeDialog(E,P)};s(function(){w(E)(H);var Q=r.innerWidth-v.prop("clientWidth");v.addClass("ngdialog-open");var P=Q-(r.innerWidth-v.prop("clientWidth"));if(P>0){q.setBodyPadding(P)}F.append(E);if(J.name){A.$broadcast("ngDialog.opened",{dialog:E,name:J.name})}else{A.$broadcast("ngDialog.opened",E)}});if(J.closeByEscape){v.bind("keydown",q.onDocumentKeydown)}if(J.closeByNavigation){A.$on("$locationChangeSuccess",function(){q.closeDialog(E)})}k=function(Q){var R=J.closeByDocument?j(Q.target).hasClass("ngdialog-overlay"):false;var P=j(Q.target).hasClass("ngdialog-close");if(R||P){x.close(E.attr("id"),P?"$closeButton":"$document")}};if(typeof g.Hammer!=="undefined"){var M=H.hammerTime=g.Hammer(E[0]);M.on("tap",k)}else{E.bind("click",k)}m+=1;return x});return{id:"ngdialog"+l,closePromise:B.promise,close:function(K){q.closeDialog(E,K)}};function G(K,L){return z.get(K,(L||{})).then(function(M){return M.data||""})}function D(K){if(!K){return"Empty template"}if(h.isString(K)&&J.plain){return K}if(typeof J.cache==="boolean"&&!J.cache){return G(K,{cache:false})}return t.get(K)||G(K,{cache:true})}},openConfirm:function(D){var E=y.defer();var C={closeByEscape:false,closeByDocument:false};h.extend(C,D);C.scope=h.isObject(C.scope)?C.scope.$new():A.$new();C.scope.confirm=function(G){E.resolve(G);var F=j(document.getElementById(B.id));q.performCloseDialog(F,G)};var B=x.open(C);B.closePromise.then(function(F){if(F){return E.reject(F.value)}return E.reject()});return E.promise},close:function(D,C){var B=j(document.getElementById(D));if(B.length){q.closeDialog(B,C)}else{x.closeAll(C)}return x},closeAll:function(C){var B=document.querySelectorAll(".ngdialog");h.forEach(B,function(D){q.closeDialog(j(D),C)})},getDefaults:function(){return n}};return x}]});c.directive("ngDialog",["ngDialog",function(k){return{restrict:"A",scope:{ngDialogScope:"="},link:function(m,n,l){n.on("click",function(q){q.preventDefault();var p=h.isDefined(m.ngDialogScope)?m.ngDialogScope:"noScope";h.isDefined(l.ngDialogClosePrevious)&&k.close(l.ngDialogClosePrevious);var o=k.getDefaults();k.open({template:l.ngDialog,className:l.ngDialogClass||o.className,controller:l.ngDialogController,scope:p,data:l.ngDialogData,showClose:l.ngDialogShowClose==="false"?false:(l.ngDialogShowClose==="true"?true:o.showClose),closeByDocument:l.ngDialogCloseByDocument==="false"?false:(l.ngDialogCloseByDocument==="true"?true:o.closeByDocument),closeByEscape:l.ngDialogCloseByEscape==="false"?false:(l.ngDialogCloseByEscape==="true"?true:o.closeByEscape),preCloseCallback:l.ngDialogPreCloseCallback||o.preCloseCallback})})}}}])})(window,window.angular);